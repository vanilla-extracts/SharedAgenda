---
- name: Create the ssh config
  ansible.builtin.import_playbook: create_ssh_config.yaml
- name: Install prerequisites
  hosts: platform_shag
  become: true
  roles:
    - prerequis
    - hosts-aliases
    - node-exporter
- name: Grafana
  ansible.builtin.import_playbook: grafana.yaml
- name: Postgres
  ansible.builtin.import_playbook: postgresql.yaml
- name: Replication
  ansible.builtin.import_playbook: replication.yaml
- name: Postgres Exporter
  hosts: platform_shag_bdds
  become: true
  roles:
    - postgres-exporter
- name: Postgresql Keepalived
  ansible.builtin.import_playbook: keepalived.yaml
- name: Install and configure the API
  ansible.builtin.import_playbook: api.yaml
- name: Install and configure Caddy
  ansible.builtin.import_playbook: caddy.yaml
